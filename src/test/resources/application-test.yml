spring:
  datasource:
    url: jdbc:h2:mem:testdb;MODE=MySQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:
  
  jpa:
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: false
        jdbc:
          batch_size: 20
    show-sql: false
  
  batch:
    job:
      enabled: false
  
  security:
    enabled: true
  
  ai:
    openai:
      api-key: test-key
      chat:
        enabled: false
  
  cache:
    type: simple
  
  mail:
    host: localhost
    port: 1025
    
  # 자동 구성 비활성화
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration
      - org.springframework.boot.actuate.autoconfigure.data.redis.RedisReactiveHealthContributorAutoConfiguration
      - org.springframework.boot.actuate.autoconfigure.data.redis.RedisHealthContributorAutoConfiguration

logging:
  level:
    root: WARN
    com.bifai: INFO
    org.springframework.web: WARN
    org.springframework.security: WARN
    org.hibernate: WARN

# 테스트용 설정
fcm:
  enabled: false

app:
  cors:
    allowed-origins: http://localhost:3000
  
  jwt:
    secret: test-jwt-secret-key-for-bifai-backend-application-test-environment-only-with-minimum-64-bytes-requirement
    access-token-expiration-ms: 900000
    refresh-token-expiration-ms: 604800000

# 로컬 파일 저장 경로 (S3 대체)
file:
  upload:
    dir: /tmp/bifai-test-files

# Resilience4j 설정
resilience4j:
  circuitbreaker:
    instances:
      default:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3
      openai-api:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3
      google-vision:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3
      weather-api:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3
      map-api:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3
      health-check:
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 30s
        halfOpenMaxCalls: 3

  ratelimiter:
    instances:
      default:
        limitForPeriod: 10
        limitRefreshPeriod: 1s
        timeoutDuration: 1s
      openai-api:
        limitForPeriod: 5
        limitRefreshPeriod: 1s
        timeoutDuration: 1s
      map-api:
        limitForPeriod: 10
        limitRefreshPeriod: 1s
        timeoutDuration: 1s

  retry:
    instances:
      default:
        maxAttempts: 3
        waitDuration: 100ms
      openai-api:
        maxAttempts: 3
        waitDuration: 100ms
      weather-api:
        maxAttempts: 3
        waitDuration: 100ms
      push-notification:
        maxAttempts: 2
        waitDuration: 50ms

  bulkhead:
    instances:
      default:
        maxConcurrentCalls: 10
        maxWaitDuration: 1s
      google-vision:
        maxConcurrentCalls: 5
        maxWaitDuration: 1s
      push-notification:
        maxConcurrentCalls: 10
        maxWaitDuration: 1s
        type: threadpool
        coreThreadPoolSize: 5
        maxThreadPoolSize: 10
        queueCapacity: 20